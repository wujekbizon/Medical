<UserControl x:Class="Medical.Views.Controls.LoadingOverlay"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialIcons="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
             >

    <UserControl.Resources>
        <!-- Spinning Animation -->
        <Storyboard x:Key="SpinAnimation" RepeatBehavior="Forever">
            <DoubleAnimation 
                Storyboard.TargetName="SpinnerIcon"
                Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                From="0" To="360" Duration="0:0:1"/>
        </Storyboard>

        <!-- Pulsing Animation for the ring -->
        <Storyboard x:Key="PulseAnimation" RepeatBehavior="Forever">
            <DoubleAnimation 
                Storyboard.TargetName="PulseRing"
                Storyboard.TargetProperty="Opacity"
                From="0.3" To="0.8" Duration="0:0:0.8"
                AutoReverse="True"/>
            <DoubleAnimation 
                Storyboard.TargetName="PulseRing"
                Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                From="0.9" To="1.1" Duration="0:0:0.8"
                AutoReverse="True"/>
            <DoubleAnimation 
                Storyboard.TargetName="PulseRing"
                Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                From="0.9" To="1.1" Duration="0:0:0.8"
                AutoReverse="True"/>
        </Storyboard>

        <!-- Fade in animation -->
        <Storyboard x:Key="FadeInAnimation">
            <DoubleAnimation 
                Storyboard.TargetProperty="Opacity"
                From="0" To="1" Duration="0:0:0.3"/>
        </Storyboard>

        <!-- Fade out animation -->
        <Storyboard x:Key="FadeOutAnimation">
            <DoubleAnimation 
                Storyboard.TargetProperty="Opacity"
                From="1" To="0" Duration="0:0:0.3"/>
        </Storyboard>

        <!-- Dot bounce animation for loading dots -->
        <Storyboard x:Key="DotsAnimation" RepeatBehavior="Forever">
            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Dot1" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                <EasingDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="-8">
                    <EasingDoubleKeyFrame.EasingFunction>
                        <QuadraticEase EasingMode="EaseOut"/>
                    </EasingDoubleKeyFrame.EasingFunction>
                </EasingDoubleKeyFrame>
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="0">
                    <EasingDoubleKeyFrame.EasingFunction>
                        <QuadraticEase EasingMode="EaseIn"/>
                    </EasingDoubleKeyFrame.EasingFunction>
                </EasingDoubleKeyFrame>
                <EasingDoubleKeyFrame KeyTime="0:0:0.9" Value="0"/>
            </DoubleAnimationUsingKeyFrames>

            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Dot2" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                <EasingDoubleKeyFrame KeyTime="0:0:0.15" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="-8">
                    <EasingDoubleKeyFrame.EasingFunction>
                        <QuadraticEase EasingMode="EaseOut"/>
                    </EasingDoubleKeyFrame.EasingFunction>
                </EasingDoubleKeyFrame>
                <EasingDoubleKeyFrame KeyTime="0:0:0.45" Value="0">
                    <EasingDoubleKeyFrame.EasingFunction>
                        <QuadraticEase EasingMode="EaseIn"/>
                    </EasingDoubleKeyFrame.EasingFunction>
                </EasingDoubleKeyFrame>
                <EasingDoubleKeyFrame KeyTime="0:0:0.9" Value="0"/>
            </DoubleAnimationUsingKeyFrames>

            <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Dot3" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.Y)">
                <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="0"/>
                <EasingDoubleKeyFrame KeyTime="0:0:0.45" Value="-8">
                    <EasingDoubleKeyFrame.EasingFunction>
                        <QuadraticEase EasingMode="EaseOut"/>
                    </EasingDoubleKeyFrame.EasingFunction>
                </EasingDoubleKeyFrame>
                <EasingDoubleKeyFrame KeyTime="0:0:0.6" Value="0">
                    <EasingDoubleKeyFrame.EasingFunction>
                        <QuadraticEase EasingMode="EaseIn"/>
                    </EasingDoubleKeyFrame.EasingFunction>
                </EasingDoubleKeyFrame>
                <EasingDoubleKeyFrame KeyTime="0:0:0.9" Value="0"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
    </UserControl.Resources>
    <Grid Background="#E6121212">
        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
        
            <Grid Width="120" Height="120" Margin="0,0,0,24">
                <!-- Pulsing outer ring -->
                <Ellipse x:Name="PulseRing"
                         Width="100" Height="100"
                         Stroke="{DynamicResource AccentPurple}"
                         StrokeThickness="3"
                         Opacity="0.5"
                         RenderTransformOrigin="0.5,0.5">
                    <Ellipse.RenderTransform>
                        <ScaleTransform ScaleX="1" ScaleY="1"/>
                    </Ellipse.RenderTransform>
                </Ellipse>

                <!-- Inner circle background -->
                <Ellipse Width="80" Height="80"
                         Fill="{DynamicResource DarkSurface}"
                         Opacity="0.9"/>

                <!-- Spinning medical icon -->
                <materialIcons:MaterialIcon 
                    x:Name="SpinnerIcon"
                    Kind="HospitalBox"
                    Width="48" Height="48"
                    Foreground="{DynamicResource AccentPurple}"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    RenderTransformOrigin="0.5,0.5">
                    <materialIcons:MaterialIcon.RenderTransform>
                        <RotateTransform Angle="0"/>
                    </materialIcons:MaterialIcon.RenderTransform>
                </materialIcons:MaterialIcon>
            </Grid>

            <!-- Loading text -->
            <TextBlock Text="Ładowanie"
                       FontSize="18"
                       FontWeight="SemiBold"
                       Foreground="{DynamicResource TextPrimary}"
                       HorizontalAlignment="Center"
                       Margin="0,0,0,8"/>

            <!-- Animated dots -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Height="20">
                <Ellipse x:Name="Dot1" Width="8" Height="8" Fill="{DynamicResource AccentPurple}" Margin="4,0">
                    <Ellipse.RenderTransform>
                        <TranslateTransform Y="0"/>
                    </Ellipse.RenderTransform>
                </Ellipse>
                <Ellipse x:Name="Dot2" Width="8" Height="8" Fill="{DynamicResource AccentPurple}" Margin="4,0">
                    <Ellipse.RenderTransform>
                        <TranslateTransform Y="0"/>
                    </Ellipse.RenderTransform>
                </Ellipse>
                <Ellipse x:Name="Dot3" Width="8" Height="8" Fill="{DynamicResource AccentPurple}" Margin="4,0">
                    <Ellipse.RenderTransform>
                        <TranslateTransform Y="0"/>
                    </Ellipse.RenderTransform>
                </Ellipse>
            </StackPanel>

            <!-- Optional status text -->
            <TextBlock x:Name="StatusText"
                       Text="Przygotowywanie danych..."
                       FontSize="12"
                       Foreground="{DynamicResource TextSecondary}"
                       HorizontalAlignment="Center"
                       Margin="0,16,0,0"/>
        </StackPanel>
    </Grid>
</UserControl>
